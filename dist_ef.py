direct_synthetic_1m_smart = '''1        0.2823  13.3285 us      133.099 dcs
2       0.4059  18.5259 us      161.454 dcs
3       0.4879  22.8038 us      184.407 dcs
4       0.5468  21.937 us       204.015 dcs
5       0.5951  25.0815 us      222.766 dcs
6       0.6376  28.1883 us      240.547 dcs
7       0.6707  31.1119 us      257.468 dcs
8       0.6965  34.0988 us      273.943 dcs
9       0.7186  36.866 us       289.787 dcs
10      0.7361  39.5296 us      304.295 dcs
11      0.7533  42.0785 us      319.227 dcs
12      0.7703  44.76 us        334.068 dcs
13      0.783   47.2897 us      348.612 dcs
14      0.7955  49.8908 us      362.59 dcs
15      0.8067  52.1892 us      376.295 dcs
16      0.8159  54.9514 us      389.916 dcs
17      0.8236  57.3235 us      403.558 dcs
18      0.8315  60.3294 us      416.701 dcs
19      0.8382  62.5142 us      430.085 dcs
20      0.8458  64.8343 us      443.64 dcs
21      0.8521  67.2114 us      456.899 dcs
22      0.8578  69.3213 us      469.948 dcs
23      0.864   72.483 us       483.027 dcs
24      0.8686  74.3246 us      495.997 dcs
25      0.8728  76.5591 us      508.938 dcs
26      0.8759  79.0532 us      521.849 dcs
27      0.8805  81.8171 us      535.035 dcs
28      0.884   84.4641 us      547.876 dcs
29      0.8875  85.6526 us      560.493 dcs
30      0.8918  88.6831 us      573.659 dcs
40      0.9229  112.11 us       698.349 dcs
50      0.9383  135.091 us      819.988 dcs
60      0.9491  157.13 us       939.377 dcs
70      0.9574  180.76 us       1056.22 dcs
80      0.9638  202.858 us      1171.44 dcs
90      0.9694  225.819 us      1284.49 dcs
100     0.9733  246.963 us      1395.69 dcs
140     0.9816  336.053 us      1824.34 dcs
180     0.985   417.859 us      2233.41 dcs
220     0.9876  500.944 us      2626.74 dcs
260     0.9896  581.433 us      3007.99 dcs
300     0.9907  662.413 us      3378.26 dcs
340     0.9915  742.479 us      3738.97 dcs
380     0.9916  821.229 us      4091.56 dcs
420     0.9922  902.909 us      4436.73 dcs
460     0.9925  980.675 us      4775.03 dcs
'''
direct_synthetic_1m_hnsw = '''1 0.2699  16.5507 us      158.614 dcs
2       0.4063  21.7333 us      188.449 dcs
3       0.4951  25.7109 us      212.118 dcs
4       0.5563  29.2705 us      232.618 dcs
5       0.6053  32.5652 us      252.059 dcs
6       0.646   37.1179 us      270.071 dcs
7       0.6792  39.6336 us      286.542 dcs
8       0.7023  42.7654 us      302.417 dcs
9       0.7262  45.5164 us      318.189 dcs
10      0.7463  48.487 us       333.269 dcs
11      0.766   51.1722 us      348.432 dcs
12      0.7814  53.867 us       362.637 dcs
13      0.7943  56.7397 us      376.466 dcs
14      0.8059  59.4262 us      390.518 dcs
15      0.8162  61.3399 us      404.402 dcs
16      0.8265  64.1151 us      417.615 dcs
17      0.8341  66.6646 us      430.999 dcs
18      0.8418  68.9042 us      444.263 dcs
19      0.8489  72.2195 us      457.265 dcs
20      0.8542  74.5989 us      470.476 dcs
21      0.8607  76.3364 us      483.415 dcs
22      0.8653  78.6828 us      496.299 dcs
23      0.8693  81.0685 us      508.89 dcs
24      0.8744  83.7992 us      521.717 dcs
25      0.8783  85.9338 us      534.412 dcs
26      0.8829  88.4656 us      546.978 dcs
27      0.8873  92.4712 us      559.633 dcs
28      0.8912  93.3081 us      572.088 dcs
29      0.8935  95.7892 us      584.837 dcs
30      0.8972  97.6797 us      597.318 dcs
40      0.9246  121.202 us      720.035 dcs
50      0.9392  143.514 us      839.745 dcs
60      0.9498  166.663 us      958.163 dcs
70      0.9598  189.947 us      1074.01 dcs
80      0.9641  211.704 us      1188.08 dcs
90      0.9685  233.347 us      1300.2 dcs
100     0.9729  255.681 us      1410.11 dcs
140     0.981   340.993 us      1836.41 dcs
180     0.9852  424.965 us      2243.63 dcs
220     0.9886  507.581 us      2635.78 dcs
260     0.9901  587.118 us      3015.68 dcs
300     0.9922  666.985 us      3384.83 dcs
340     0.9926  746.869 us      3744.46 dcs
380     0.9939  824.716 us      4096.21 dcs
420     0.9939  904.961 us      4441.1 dcs
460     0.9936  984.647 us      4778.43 dcs
'''


deep_rnd_10m_1NN = '''1	0.1825	28.5502 us	174.222 dcs
2	0.2898	35.2562 us	211.488 dcs
3	0.3673	42.5049 us	241.852 dcs
4	0.4224	47.7303 us	268.393 dcs
5	0.4716	53.5534 us	292.993 dcs
6	0.5146	58.0461 us	316.277 dcs
7	0.5483	63.9041 us	337.243 dcs
8	0.5754	67.4785 us	357.607 dcs
9	0.5998	71.4882 us	376.917 dcs
10	0.6214	75.7291 us	395.048 dcs
11	0.639	79.5215 us	413.238 dcs
12	0.6553	83.4085 us	430.686 dcs
13	0.6684	87.1259 us	447.647 dcs
14	0.6823	91.6074 us	464.935 dcs
15	0.6954	94.3978 us	480.956 dcs
16	0.7071	98.6145 us	497.287 dcs
17	0.7169	101.985 us	513.251 dcs
18	0.7259	105.8 us	528.899 dcs
19	0.7353	109.042 us	543.885 dcs
20	0.7442	113.637 us	559.556 dcs
21	0.7519	116.173 us	575.057 dcs
22	0.7589	119.835 us	590.2 dcs
23	0.7666	123.201 us	605.29 dcs
24	0.7732	126.768 us	620.337 dcs
25	0.7797	129.735 us	634.6 dcs
26	0.7848	133.305 us	649.576 dcs
27	0.7885	137.109 us	663.98 dcs
28	0.7946	139.912 us	678.481 dcs
29	0.8008	143.407 us	692.846 dcs
30	0.8062	146.781 us	707.069 dcs
40	0.8427	179.261 us	847.566 dcs
50	0.8644	210.901 us	983.712 dcs
60	0.8803	242.531 us	1117.24 dcs
70	0.8924	274.69 us	1248.47 dcs
80	0.9038	306.007 us	1377.03 dcs
90	0.9115	335.698 us	1503.76 dcs
100	0.9183	367.361 us	1628.62 dcs
140	0.9391	488.893 us	2114.23 dcs
180	0.9514	607.84 us	2580.85 dcs
220	0.9597	722.052 us	3030.06 dcs
260	0.9643	835.635 us	3467.82 dcs
300	0.9689	950.206 us	3893.36 dcs
340	0.9717	1063.21 us	4310.23 dcs
380	0.9746	1174.39 us	4718.46 dcs
420	0.977	1284.77 us	5119.89 dcs
460	0.9786	1394.66 us	5513.48 dcs
'''

deep_one_layer_10m_1NN='''1	0.1178	18.8848 us	160.528 dcs
2	0.2526	30.5234 us	222.607 dcs
3	0.3506	37.995 us	263.819 dcs
4	0.4198	44.5429 us	295.797 dcs
5	0.4676	49.7692 us	321.558 dcs
6	0.5082	55.0233 us	345.924 dcs
7	0.5418	59.9831 us	367.912 dcs
8	0.5718	64.7451 us	388.974 dcs
9	0.5981	68.9627 us	408.254 dcs
10	0.6194	73.2117 us	426.449 dcs
11	0.6398	77.14 us	444.86 dcs
12	0.6568	81.3903 us	462.601 dcs
13	0.6731	84.6925 us	479.837 dcs
14	0.6854	88.6352 us	496.577 dcs
15	0.6995	92.2369 us	512.967 dcs
16	0.7106	96.4713 us	529.208 dcs
17	0.7206	99.4423 us	545.657 dcs
18	0.7292	103.558 us	560.936 dcs
19	0.7385	106.4 us	576.458 dcs
20	0.7467	110.589 us	591.446 dcs
21	0.7551	117.064 us	606.293 dcs
22	0.7625	116.831 us	621.147 dcs
23	0.7685	119.404 us	636.246 dcs
24	0.775	123.013 us	650.858 dcs
25	0.7815	125.315 us	665.237 dcs
26	0.7873	129.309 us	680.243 dcs
27	0.7946	131.214 us	695.085 dcs
28	0.7992	135.303 us	709.433 dcs
29	0.8044	133.906 us	723.951 dcs
30	0.8109	141.238 us	738.518 dcs
40	0.8463	171.877 us	878.237 dcs
50	0.8687	200.191 us	1013.71 dcs
60	0.8848	228 us	1147.56 dcs
70	0.8963	256.67 us	1277.87 dcs
80	0.9064	286.971 us	1405.67 dcs
90	0.9158	318.504 us	1532.28 dcs
100	0.9224	344.443 us	1656.86 dcs
140	0.9437	456.521 us	2139.86 dcs
180	0.9548	565.133 us	2606.87 dcs
220	0.9625	662.722 us	3055.95 dcs
260	0.9693	760.447 us	3493.28 dcs
300	0.9734	862.092 us	3918.49 dcs
340	0.9756	963.89 us	4335.04 dcs
380	0.9779	1064.54 us	4743.23 dcs
420	0.9791	1162.9 us	5144.06 dcs
460	0.981	1261.43 us	5537.89 dcs
'''

rnd_10m_M8_1NN = '''1   0.1091  19.0918 us      124.029 dcs
2       0.1855  24.3465 us      146.726 dcs
3       0.2432  29.0672 us      167.074 dcs
4       0.2945  34.2306 us      185.428 dcs
5       0.3378  37.4945 us      202 dcs
6       0.3733  41.3034 us      217.634 dcs
7       0.4054  44.409 us       232.324 dcs
8       0.4292  48.1565 us      246.015 dcs
9       0.4517  50.993 us       259.545 dcs
10      0.4722  55.1208 us      272.443 dcs
11      0.4896  57.1778 us      284.635 dcs
12      0.5078  60.5105 us      296.863 dcs
13      0.5261  62.8702 us      309.435 dcs
14      0.5411  66.0946 us      320.803 dcs
15      0.5534  68.6285 us      332.168 dcs
16      0.5671  71.7084 us      343.686 dcs
17      0.5801  74.8964 us      355.101 dcs
18      0.5913  77.0662 us      365.954 dcs
19      0.6014  79.4376 us      376.541 dcs
20      0.6097  81.7916 us      387.194 dcs
21      0.6194  84.6487 us      397.7 dcs
22      0.6296  87.4025 us      408.421 dcs
23      0.6396  90.4311 us      418.929 dcs
24      0.6475  92.4766 us      429.555 dcs
25      0.6557  94.837 us       440.186 dcs
26      0.6627  97.9559 us      450.608 dcs
27      0.669   99.719 us       460.578 dcs
28      0.6747  102.192 us      470.369 dcs
29      0.6804  104.354 us      480.25 dcs
30      0.6863  107.486 us      490.102 dcs
40      0.7315  130.595 us      585.982 dcs
50      0.7673  153.508 us      679.414 dcs
60      0.7937  175.722 us      771.371 dcs
70      0.8123  198.109 us      860.023 dcs
80      0.8324  222.936 us      948.85 dcs
90      0.8479  242.213 us      1035.44 dcs
100     0.8584  264.955 us      1121.64 dcs
140     0.8897  349.85 us       1461 dcs
180     0.9106  434.801 us      1790.73 dcs
220     0.9249  518.263 us      2113.02 dcs
260     0.9348  604.235 us      2430.12 dcs
300     0.9441  689.221 us      2741.58 dcs
340     0.9504  770.851 us      3046.86 dcs
380     0.9555  853.363 us      3348.88 dcs
420     0.9594  934.699 us      3647.52 dcs
460     0.9626  1013.73 us      3941.67 dcs
'''
one_layer_10m_M8_1NN = '''1     0.0364  10.7973 us      89.2048 dcs
2       0.1176  20.7196 us      134.693 dcs
3       0.1893  27.1654 us      167.231 dcs
4       0.2439  33.0436 us      192.422 dcs
5       0.2874  38.6573 us      213.978 dcs
6       0.3291  42.9903 us      233.271 dcs
7       0.3645  47.4764 us      251.421 dcs
8       0.3967  52.6256 us      268.699 dcs
9       0.425   55.6021 us      284.6 dcs
10      0.4477  59.4584 us      299.276 dcs
11      0.4691  63.1971 us      312.918 dcs
12      0.4874  66.3427 us      326.004 dcs
13      0.5076  68.8554 us      339.483 dcs
14      0.5232  72.4595 us      351.821 dcs
15      0.5409  75.5165 us      364.273 dcs
16      0.5544  78.4333 us      376.147 dcs
17      0.5668  81.3503 us      388.184 dcs
18      0.5813  84.2439 us      400.01 dcs
19      0.5914  86.6698 us      411.224 dcs
20      0.6037  90.4925 us      422.751 dcs
21      0.6126  92.1806 us      433.841 dcs
22      0.6227  96.1364 us      444.732 dcs
23      0.6296  97.766 us       455.182 dcs
24      0.6386  100.249 us      465.925 dcs
25      0.6461  102.531 us      476.2 dcs
26      0.6543  105.167 us      486.738 dcs
27      0.6622  107.243 us      496.875 dcs
28      0.669   110.494 us      506.711 dcs
29      0.6742  111.545 us      516.861 dcs
30      0.6792  114.355 us      526.35 dcs
40      0.7295  138.618 us      624.478 dcs
50      0.7659  161.364 us      719.015 dcs
60      0.7895  182.818 us      810.375 dcs
70      0.8101  204.424 us      900.114 dcs
80      0.8271  230.417 us      988.621 dcs
90      0.8413  252.821 us      1075.69 dcs
100     0.8537  276.102 us      1162.19 dcs
140     0.8875  360.575 us      1499.12 dcs
180     0.9095  437.826 us      1829.75 dcs
220     0.9226  519.492 us      2152.96 dcs
260     0.9354  601.88 us       2468.81 dcs
300     0.9433  682.555 us      2779.82 dcs
340     0.9493  764.41 us       3085.26 dcs
380     0.9531  844.135 us      3386.59 dcs
420     0.9567  923.126 us      3684.19 dcs
460     0.9588  1002.13 us      3978.81 dcs
'''
rnd_10m_M4_1NN = '''1   0.0365  11.3665 us      78.691 dcs
2       0.0646  13.8963 us      90.4252 dcs
3       0.0928  16.6249 us      101.706 dcs
4       0.1172  19.5719 us      112.125 dcs
5       0.1411  22.0166 us      122.409 dcs
6       0.1624  24.8757 us      131.987 dcs
7       0.1804  27.2975 us      141.186 dcs
8       0.1986  29.3273 us      149.77 dcs
9       0.2144  31.5567 us      158.171 dcs
10      0.2276  33.9749 us      166.35 dcs
11      0.2393  34.9421 us      174.31 dcs
12      0.2515  37.9372 us      181.992 dcs
13      0.2641  39.2157 us      189.201 dcs
14      0.275   41.6634 us      196.66 dcs
15      0.2855  43.8831 us      203.724 dcs
16      0.2966  46.1313 us      210.915 dcs
17      0.3054  48.3773 us      217.808 dcs
18      0.3138  49.1693 us      224.365 dcs
19      0.3232  51.0029 us      231.153 dcs
20      0.3332  53.0416 us      237.817 dcs
21      0.3402  54.2365 us      244.158 dcs
22      0.3457  56.028 us       250.279 dcs
23      0.354   57.6374 us      256.622 dcs
24      0.3621  59.4579 us      262.969 dcs
25      0.3706  61.0339 us      269.569 dcs
26      0.3786  62.8315 us      275.877 dcs
27      0.3835  64.2647 us      281.772 dcs
28      0.3891  65.7464 us      287.876 dcs
29      0.3947  67.4751 us      293.658 dcs
30      0.4003  68.6195 us      299.629 dcs
40      0.4477  84.5473 us      355.344 dcs
50      0.4836  98.6906 us      408.46 dcs
60      0.5126  112.208 us      458.937 dcs
70      0.5375  125.765 us      509.232 dcs
80      0.5577  141.746 us      557.873 dcs
90      0.5754  152.285 us      605.174 dcs
100     0.5898  166.269 us      653.013 dcs
140     0.6372  216.532 us      836.771 dcs
180     0.6714  267.55 us       1016.74 dcs
220     0.698   317.51 us       1192.79 dcs
260     0.7186  364.168 us      1366.56 dcs
300     0.7378  413.743 us      1538.48 dcs
340     0.7537  465.284 us      1707.07 dcs
380     0.7645  514.987 us      1875.79 dcs
420     0.7761  563.976 us      2042.2 dcs
460     0.7864  611.814 us      2206.64 dcs
'''

one_layer_10m_M4_1NN = '''1     0.0062  4.1198 us       40.201 dcs
2       0.0301  9.2788 us       67.8529 dcs
3       0.061   13.1954 us      87.6639 dcs
4       0.0886  17.3241 us      104.063 dcs
5       0.1133  20.576 us       118.423 dcs
6       0.1376  23.6224 us      131.254 dcs
7       0.1598  26.0811 us      143.119 dcs
8       0.1819  29.7049 us      154.093 dcs
9       0.1976  31.6295 us      163.923 dcs
10      0.2127  33.8242 us      173.291 dcs
11      0.2262  35.914 us       182.238 dcs
12      0.2395  38.516 us       191.269 dcs
13      0.2515  39.8356 us      199.824 dcs
14      0.2614  42.1907 us      207.528 dcs
15      0.2721  44.0624 us      215.297 dcs
16      0.2831  46.5758 us      223.035 dcs
17      0.2921  48.1821 us      230.395 dcs
18      0.3005  50.041 us       237.442 dcs
19      0.3105  51.7398 us      244.875 dcs
20      0.3193  53.7096 us      252.341 dcs
21      0.3275  55.3246 us      259.576 dcs
22      0.3356  57.4095 us      266.324 dcs
23      0.3432  58.3877 us      273.441 dcs
24      0.3491  60.5233 us      279.823 dcs
25      0.3568  61.6611 us      286.435 dcs
26      0.3635  63.3142 us      292.727 dcs
27      0.3704  64.5929 us      299.062 dcs
28      0.3765  66.4465 us      305.018 dcs
29      0.3818  67.3851 us      311.149 dcs
30      0.3876  68.926 us       317.112 dcs
40      0.4355  83.1711 us      374.692 dcs
50      0.4738  96.2111 us      428.581 dcs
60      0.5055  108.36 us       480.443 dcs
70      0.5303  121.01 us       530.574 dcs
80      0.5488  134.022 us      580.026 dcs
90      0.568   145.923 us      628.724 dcs
100     0.5849  157.577 us      675.763 dcs
140     0.6374  204.367 us      862.359 dcs
180     0.6738  250.32 us       1040.92 dcs
220     0.6975  294.51 us       1216.49 dcs
260     0.7174  346.033 us      1389.8 dcs
300     0.7345  392.841 us      1560.14 dcs
340     0.7459  433.247 us      1729.49 dcs
380     0.7586  475.59 us       1897.6 dcs
420     0.7697  520.466 us      2064.75 dcs
460     0.7776  566.581 us      2229.07 dcs
'''

import matplotlib.pyplot as plt
import numpy
import re

M = 1

splitted_smart = re.findall(r"[0-9.]+", direct_synthetic_1m_smart)
splitted_hnsw = re.findall(r"[0-9.]+", direct_synthetic_1m_hnsw)

ef = range(1,30) + range(30, 100, 10) + range(100, 500, 40)


smart_dcs = splitted_smart[3::4]
hnsw_dcs = splitted_hnsw[3::4]

plt.plot(ef, smart_dcs, 'r--')
plt.plot(ef, hnsw_dcs)
plt.axis([1, 460, 0, 7000])
plt.xlabel('Ef', fontsize=14)
plt.ylabel('Distance Count', fontsize=14)
plt.text(ef[-1]+1, float(smart_dcs[-1])-50, 'Smart HNSW', fontsize=11, color=(1,0,0))
plt.text(ef[-1]+1, float(hnsw_dcs[-1])+50, 'HNSW', fontsize=11, color=(0,0,1))
plt.title('SIFT ' + str(M) + 'M M16 Direct Distance Count/Ef')
plt.savefig('dist_ef_sift' + str(M) + 'M_M16_direct.png')
#plt.s:ow()
