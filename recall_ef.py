direct_synthetic_1m_smart = '''1	0.2823	13.3285 us	133.099 dcs
2	0.4059	18.5259 us	161.454 dcs
3	0.4879	22.8038 us	184.407 dcs
4	0.5468	21.937 us	204.015 dcs
5	0.5951	25.0815 us	222.766 dcs
6	0.6376	28.1883 us	240.547 dcs
7	0.6707	31.1119 us	257.468 dcs
8	0.6965	34.0988 us	273.943 dcs
9	0.7186	36.866 us	289.787 dcs
10	0.7361	39.5296 us	304.295 dcs
11	0.7533	42.0785 us	319.227 dcs
12	0.7703	44.76 us	334.068 dcs
13	0.783	47.2897 us	348.612 dcs
14	0.7955	49.8908 us	362.59 dcs
15	0.8067	52.1892 us	376.295 dcs
16	0.8159	54.9514 us	389.916 dcs
17	0.8236	57.3235 us	403.558 dcs
18	0.8315	60.3294 us	416.701 dcs
19	0.8382	62.5142 us	430.085 dcs
20	0.8458	64.8343 us	443.64 dcs
21	0.8521	67.2114 us	456.899 dcs
22	0.8578	69.3213 us	469.948 dcs
23	0.864	72.483 us	483.027 dcs
24	0.8686	74.3246 us	495.997 dcs
25	0.8728	76.5591 us	508.938 dcs
26	0.8759	79.0532 us	521.849 dcs
27	0.8805	81.8171 us	535.035 dcs
28	0.884	84.4641 us	547.876 dcs
29	0.8875	85.6526 us	560.493 dcs
30	0.8918	88.6831 us	573.659 dcs
40	0.9229	112.11 us	698.349 dcs
50	0.9383	135.091 us	819.988 dcs
60	0.9491	157.13 us	939.377 dcs
70	0.9574	180.76 us	1056.22 dcs
80	0.9638	202.858 us	1171.44 dcs
90	0.9694	225.819 us	1284.49 dcs
100	0.9733	246.963 us	1395.69 dcs
140	0.9816	336.053 us	1824.34 dcs
180	0.985	417.859 us	2233.41 dcs
220	0.9876	500.944 us	2626.74 dcs
260	0.9896	581.433 us	3007.99 dcs
300	0.9907	662.413 us	3378.26 dcs
340	0.9915	742.479 us	3738.97 dcs
380	0.9916	821.229 us	4091.56 dcs
420	0.9922	902.909 us	4436.73 dcs
460	0.9925	980.675 us	4775.03 dcs
'''
direct_synthetic_1m_hnsw = '''1	0.2699	16.5507 us	158.614 dcs
2	0.4063	21.7333 us	188.449 dcs
3	0.4951	25.7109 us	212.118 dcs
4	0.5563	29.2705 us	232.618 dcs
5	0.6053	32.5652 us	252.059 dcs
6	0.646	37.1179 us	270.071 dcs
7	0.6792	39.6336 us	286.542 dcs
8	0.7023	42.7654 us	302.417 dcs
9	0.7262	45.5164 us	318.189 dcs
10	0.7463	48.487 us	333.269 dcs
11	0.766	51.1722 us	348.432 dcs
12	0.7814	53.867 us	362.637 dcs
13	0.7943	56.7397 us	376.466 dcs
14	0.8059	59.4262 us	390.518 dcs
15	0.8162	61.3399 us	404.402 dcs
16	0.8265	64.1151 us	417.615 dcs
17	0.8341	66.6646 us	430.999 dcs
18	0.8418	68.9042 us	444.263 dcs
19	0.8489	72.2195 us	457.265 dcs
20	0.8542	74.5989 us	470.476 dcs
21	0.8607	76.3364 us	483.415 dcs
22	0.8653	78.6828 us	496.299 dcs
23	0.8693	81.0685 us	508.89 dcs
24	0.8744	83.7992 us	521.717 dcs
25	0.8783	85.9338 us	534.412 dcs
26	0.8829	88.4656 us	546.978 dcs
27	0.8873	92.4712 us	559.633 dcs
28	0.8912	93.3081 us	572.088 dcs
29	0.8935	95.7892 us	584.837 dcs
30	0.8972	97.6797 us	597.318 dcs
40	0.9246	121.202 us	720.035 dcs
50	0.9392	143.514 us	839.745 dcs
60	0.9498	166.663 us	958.163 dcs
70	0.9598	189.947 us	1074.01 dcs
80	0.9641	211.704 us	1188.08 dcs
90	0.9685	233.347 us	1300.2 dcs
100	0.9729	255.681 us	1410.11 dcs
140	0.981	340.993 us	1836.41 dcs
180	0.9852	424.965 us	2243.63 dcs
220	0.9886	507.581 us	2635.78 dcs
260	0.9901	587.118 us	3015.68 dcs
300	0.9922	666.985 us	3384.83 dcs
340	0.9926	746.869 us	3744.46 dcs
380	0.9939	824.716 us	4096.21 dcs
420	0.9939	904.961 us	4441.1 dcs
460	0.9936	984.647 us	4778.43 dcs
'''

reversed_synthetic_1m_smart = '''1	0.3031	11.7839 us	138.175 dcs
2	0.4193	16.8298 us	171.694 dcs
3	0.4937	20.8549 us	196.716 dcs
4	0.5578	24.595 us	219.608 dcs
5	0.6022	28.0679 us	240.316 dcs
6	0.6418	31.0616 us	259.848 dcs
7	0.6741	34.2297 us	278.3 dcs
8	0.702	38.2007 us	296.049 dcs
9	0.7253	40.778 us	313.042 dcs
10	0.7472	43.9885 us	329.705 dcs
11	0.7651	46.8019 us	345.535 dcs
12	0.7786	49.3736 us	361.156 dcs
13	0.7918	52.1498 us	377.111 dcs
14	0.805	54.7987 us	392.484 dcs
15	0.8149	56.4674 us	407.404 dcs
16	0.8247	60.2138 us	422.009 dcs
17	0.834	63.3971 us	436.767 dcs
18	0.8417	65.3542 us	451.099 dcs
19	0.8463	68.2668 us	465.326 dcs
20	0.8537	70.095 us	479.157 dcs
21	0.8599	73.7188 us	493.566 dcs
22	0.8657	75.6336 us	507.827 dcs
23	0.8715	79.478 us	521.891 dcs
24	0.8753	81.0352 us	535.93 dcs
25	0.8797	82.7918 us	550.036 dcs
26	0.8839	87.076 us	563.892 dcs
27	0.8873	87.6409 us	577.495 dcs
28	0.8923	90.5252 us	591.182 dcs
29	0.896	92.5296 us	604.892 dcs
30	0.8979	95.1872 us	618.266 dcs
40	0.9237	119.301 us	750.861 dcs
50	0.9388	142.836 us	880.972 dcs
60	0.9492	166.642 us	1007.47 dcs
70	0.958	189.424 us	1130.46 dcs
80	0.963	214.273 us	1251.45 dcs
90	0.9671	233.302 us	1370.41 dcs
100	0.9709	255.125 us	1485.75 dcs
140	0.979	342.345 us	1931.08 dcs
180	0.9831	421.668 us	2352.74 dcs
220	0.9855	501.707 us	2755.33 dcs
260	0.9867	578.58 us	3140.99 dcs
300	0.9887	655.938 us	3515.51 dcs
340	0.9895	731.783 us	3879.18 dcs
380	0.99	807.749 us	4232.89 dcs
420	0.9908	879.818 us	4578.57 dcs
460	0.9916	952.254 us	4917.33 dcs
'''

reversed_synthetic_1m_hnsw = '''1	0.2629	17.2291 us	165.918 dcs
2	0.3924	22.6847 us	199.233 dcs
3	0.4773	27.2479 us	225.862 dcs
4	0.5426	31.2979 us	248.383 dcs
5	0.5958	34.5707 us	269.056 dcs
6	0.6351	38.4069 us	288.44 dcs
7	0.6691	42.7005 us	306.719 dcs
8	0.6951	46.2267 us	324.292 dcs
9	0.7174	48.7538 us	341.209 dcs
10	0.7372	52.3999 us	357.651 dcs
11	0.7546	55.0433 us	373.67 dcs
12	0.7695	57.8059 us	388.732 dcs
13	0.7833	60.2133 us	404.43 dcs
14	0.7954	64.0301 us	419.221 dcs
15	0.8042	65.8575 us	433.613 dcs
16	0.8152	68.4259 us	448.219 dcs
17	0.8234	70.8194 us	462.685 dcs
18	0.8315	73.4672 us	476.994 dcs
19	0.8382	76.047 us	491.309 dcs
20	0.8452	78.9012 us	505.178 dcs
21	0.8507	82.1173 us	519.208 dcs
22	0.8569	84.5611 us	532.927 dcs
23	0.8612	86.3913 us	546.719 dcs
24	0.8659	88.768 us	560.341 dcs
25	0.8691	91.26 us	574.294 dcs
26	0.8745	93.9437 us	588.37 dcs
27	0.8794	96.2317 us	601.797 dcs
28	0.8834	99.0615 us	615.14 dcs
29	0.8864	101.081 us	628.667 dcs
30	0.8892	103.561 us	641.736 dcs
40	0.9152	127.96 us	772.432 dcs
50	0.9314	151.83 us	901.565 dcs
60	0.942	174.687 us	1027.41 dcs
70	0.9504	197.938 us	1149.72 dcs
80	0.9555	220.805 us	1270.26 dcs
90	0.9608	244.949 us	1388.48 dcs
100	0.9633	267.043 us	1503.67 dcs
140	0.972	351.948 us	1947.97 dcs
180	0.9766	436.386 us	2368.55 dcs
220	0.9807	517.011 us	2770.54 dcs
260	0.9823	598.585 us	3157.2 dcs
300	0.984	676.33 us	3531.67 dcs
340	0.9852	754.419 us	3895.7 dcs
380	0.9863	824.882 us	4250.22 dcs
420	0.9871	898.588 us	4596.84 dcs
460	0.9881	970.4 us	4936.74 dcs
'''

deep_rnd_10m_1NN = '''1	0.1825	28.5502 us	174.222 dcs
2	0.2898	35.2562 us	211.488 dcs
3	0.3673	42.5049 us	241.852 dcs
4	0.4224	47.7303 us	268.393 dcs
5	0.4716	53.5534 us	292.993 dcs
6	0.5146	58.0461 us	316.277 dcs
7	0.5483	63.9041 us	337.243 dcs
8	0.5754	67.4785 us	357.607 dcs
9	0.5998	71.4882 us	376.917 dcs
10	0.6214	75.7291 us	395.048 dcs
11	0.639	79.5215 us	413.238 dcs
12	0.6553	83.4085 us	430.686 dcs
13	0.6684	87.1259 us	447.647 dcs
14	0.6823	91.6074 us	464.935 dcs
15	0.6954	94.3978 us	480.956 dcs
16	0.7071	98.6145 us	497.287 dcs
17	0.7169	101.985 us	513.251 dcs
18	0.7259	105.8 us	528.899 dcs
19	0.7353	109.042 us	543.885 dcs
20	0.7442	113.637 us	559.556 dcs
21	0.7519	116.173 us	575.057 dcs
22	0.7589	119.835 us	590.2 dcs
23	0.7666	123.201 us	605.29 dcs
24	0.7732	126.768 us	620.337 dcs
25	0.7797	129.735 us	634.6 dcs
26	0.7848	133.305 us	649.576 dcs
27	0.7885	137.109 us	663.98 dcs
28	0.7946	139.912 us	678.481 dcs
29	0.8008	143.407 us	692.846 dcs
30	0.8062	146.781 us	707.069 dcs
40	0.8427	179.261 us	847.566 dcs
50	0.8644	210.901 us	983.712 dcs
60	0.8803	242.531 us	1117.24 dcs
70	0.8924	274.69 us	1248.47 dcs
80	0.9038	306.007 us	1377.03 dcs
90	0.9115	335.698 us	1503.76 dcs
100	0.9183	367.361 us	1628.62 dcs
140	0.9391	488.893 us	2114.23 dcs
180	0.9514	607.84 us	2580.85 dcs
220	0.9597	722.052 us	3030.06 dcs
260	0.9643	835.635 us	3467.82 dcs
300	0.9689	950.206 us	3893.36 dcs
340	0.9717	1063.21 us	4310.23 dcs
380	0.9746	1174.39 us	4718.46 dcs
420	0.977	1284.77 us	5119.89 dcs
460	0.9786	1394.66 us	5513.48 dcs
'''

deep_one_layer_10m_1NN = '''1	0.1178	18.8848 us	160.528 dcs
2	0.2526	30.5234 us	222.607 dcs
3	0.3506	37.995 us	263.819 dcs
4	0.4198	44.5429 us	295.797 dcs
5	0.4676	49.7692 us	321.558 dcs
6	0.5082	55.0233 us	345.924 dcs
7	0.5418	59.9831 us	367.912 dcs
8	0.5718	64.7451 us	388.974 dcs
9	0.5981	68.9627 us	408.254 dcs
10	0.6194	73.2117 us	426.449 dcs
11	0.6398	77.14 us	444.86 dcs
12	0.6568	81.3903 us	462.601 dcs
13	0.6731	84.6925 us	479.837 dcs
14	0.6854	88.6352 us	496.577 dcs
15	0.6995	92.2369 us	512.967 dcs
16	0.7106	96.4713 us	529.208 dcs
17	0.7206	99.4423 us	545.657 dcs
18	0.7292	103.558 us	560.936 dcs
19	0.7385	106.4 us	576.458 dcs
20	0.7467	110.589 us	591.446 dcs
21	0.7551	117.064 us	606.293 dcs
22	0.7625	116.831 us	621.147 dcs
23	0.7685	119.404 us	636.246 dcs
24	0.775	123.013 us	650.858 dcs
25	0.7815	125.315 us	665.237 dcs
26	0.7873	129.309 us	680.243 dcs
27	0.7946	131.214 us	695.085 dcs
28	0.7992	135.303 us	709.433 dcs
29	0.8044	133.906 us	723.951 dcs
30	0.8109	141.238 us	738.518 dcs
40	0.8463	171.877 us	878.237 dcs
50	0.8687	200.191 us	1013.71 dcs
60	0.8848	228 us	1147.56 dcs
70	0.8963	256.67 us	1277.87 dcs
80	0.9064	286.971 us	1405.67 dcs
90	0.9158	318.504 us	1532.28 dcs
100	0.9224	344.443 us	1656.86 dcs
140	0.9437	456.521 us	2139.86 dcs
180	0.9548	565.133 us	2606.87 dcs
220	0.9625	662.722 us	3055.95 dcs
260	0.9693	760.447 us	3493.28 dcs
300	0.9734	862.092 us	3918.49 dcs
340	0.9756	963.89 us	4335.04 dcs
380	0.9779	1064.54 us	4743.23 dcs
420	0.9791	1162.9 us	5144.06 dcs
460	0.981	1261.43 us	5537.89 dcs
'''

import matplotlib.pyplot as plt
import numpy
import re

M = 1

splitted_smart = re.findall(r"[0-9.]+", direct_synthetic_1m_smart)
splitted_hnsw = re.findall(r"[0-9.]+", direct_synthetic_1m_hnsw)

ef = range(1,30) + range(30, 100, 10) + range(100, 500, 40)


smart_recall = splitted_smart[1::4]
hnsw_recall = splitted_hnsw[1::4]

plt.plot(ef, smart_recall, 'r--')
plt.plot(ef, hnsw_recall)
plt.axis([1, 460, 0, 1])
plt.xlabel('Ef', fontsize=14)
plt.ylabel('Recall@R', fontsize=14)
plt.text(ef[-1]+1, smart_recall[-1], 'Smart HNSW', fontsize=11, color=(1,0,0))
plt.text(ef[-1]+1, float(hnsw_recall[-1])-0.05, 'HNSW', fontsize=11, color=(0,0,1))
plt.title('SIFT' + str(M) + 'M M16 Direct Recall/Ef')
plt.savefig('recall_ef_sift' + str(M) + 'M_M16_direct.png')
#plt.s:ow()
